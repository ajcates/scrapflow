# RoadMap: General Mobile Web Scraper

## Project Overview
A general-purpose mobile web scraper application. The user defines scraping rules interactively by selecting elements on a webpage loaded within a proxy frame. The backend then executes these rules using Playwright.

### Tech Stack
- **Frontend**: Vue.js (TypeScript)
- **Backend**: Express.js (TypeScript)
- **Scraping Engine**: Playwright
- **Styling**: Material 3 Expressive (using Web Components or similar), Custom CSS (No Tailwind).
- **Architecture**: Monorepo (`client/`, `server/`).
- **Data Storage**: Flat JSON files.

---

## Phase 1: Project Initialization & Architecture
- [ ] **Monorepo Setup**
    - Initialize `package.json` in root.
    - Set up workspaces for `client` and `server`.
    - Configure TypeScript (`tsconfig.json`) for both packages.
- [ ] **Backend Boilerplate**
    - Setup Express server with TypeScript.
    - Implement basic error handling and logging.
- [ ] **Frontend Boilerplate**
    - Setup Vue.js 3 project with TypeScript.
    - Configure Material 3 UI library integration.
    - Setup global CSS file structure (separation of concerns).

## Phase 2: The Proxy "Driver" System
- [ ] **Proxy Architecture**
    - Design a `ProxyDriver` interface/adapter pattern.
    - Ensure the system allows easy swapping of proxy implementations.
- [ ] **Default Proxy Implementation**
    - Build a custom proxy capable of fetching a URL.
    - Implement HTML parsing and path rewriting (for CSS, JS, Images, and Links) so the target site loads correctly in the frontend iframe without CORS issues.
    - Ensure the proxy emulates a **Mobile User Agent**.

## Phase 3: Frontend Core & Interactivity (The Builder)
- [ ] **App Shell**
    - Implement the "Material 3 Expressive" layout.
    - Main Toolbar (Top) and Viewport Iframe.
- [ ] **DOM Interaction**
    - Implement logic to detect clicks/hovers inside the iframe (via the proxy's rewritten content or postMessage communication).
    - **"Select Items" Mode**:
        - Highlight selected `div`.
        - Auto-detect and highlight sibling elements with badges/numbers.
- [ ] **"Foreach" Mode & Configuration**
    - Implement the secondary "Foreach" Toolbar (Bottom).
    - **Add Property**: Select sub-elements, name them (Popup dialog), highlight matching sub-elements in siblings.
    - **Add Link**: Select links, handle navigation to the new link within the iframe (recursive configuration).
    - **Add Image**: Select image elements.
- [ ] **Pagination Logic**
    - "Select Next" button implementation.
    - Logic to identify and highlight the "Next Page" link.

## Phase 4: The Scraping Engine (Backend)
- [ ] **Scraper Service**
    - Integrate `playwright` (referencing `playwright-termux` context if applicable).
    - Create a flexible `Scraper` class that accepts the JSON configuration generated by the frontend.
- [ ] **Execution Logic**
    - Implement the scraping loop:
        1. Navigate to URL (Mobile User Agent).
        2. Wait for selectors.
        3. Extract "Foreach" items.
        4. Handle recursive link scraping (deep dive).
        5. Handle Pagination (click next, wait, repeat).
- [ ] **Data Persistence**
    - Implement file system logic to save results as flat JSON files.
    - Save the "Scraping Definition" (rules) separately for re-runs.

## Phase 5: Review & Refinement
- [ ] **Results Viewer**
    - Frontend page to view saved JSON files.
    - Implement filtering logic (contains/does not contain).
- [ ] **Re-running Jobs**
    - UI to load an existing scraping definition and restart the job (Append or Replace mode).
- [ ] **Polishing**
    - Ensure "Code is highly cohesive and loosely coupled".
    - Add comprehensive comments explaining "what and why".
    - Verify Mobile-First responsiveness.
